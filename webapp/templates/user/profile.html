{% extends 'base.html' %}

{% block content %}

<div class="container">
    <h1 class="mb-4">Профиль пользователя</h1>
    {% include('messages.html') %}
    <div class="card">
        <div class="card-body">
            <p class="mb-2"><strong>ID:</strong> {{ user.id }}</p>
            <p class="mb-2"><strong>Имя пользователя:</strong> {{ user.username }}</p>
            <p class="mb-2"><strong>Email:</strong> {{ user.email }}</p>
            <p class="mb-2"><strong>Рейтинг:</strong> {{ user.rating }}</p>
            <img class="rounded" src="{{ user.avatar }}" alt="Аватар пользователя" width="100" height="100">
        </div>
    </div>
    {% if current_user.username == user.username or current_user.is_admin %}
    <form action="{{ url_for('user.edit_profile') }}" method="post">
      <div class="mb-3">
          <label for="username" class="form-label">Логин</label>
          <input type="text" class="form-control" id="username" name="username" value="{{ user.username }}" required>
      </div>
      <div class="mb-3">
          <label for="email" class="form-label">Email</label>
          <input type="email" class="form-control" id="email" name="email" value="{{ user.email }}" required>
      </div>
      <div class="mb-3">
          <label for="old_password" class="form-label">Старый пароль</label>
          <input type="password" class="form-control" id="old_password" name="old_password" placeholder="Введите старый пароль">
      </div>
      <div class="mb-3">
        <label for="password" class="form-label">Новый пароль</label>
        <input type="password" class="form-control" id="password" name="password" placeholder="Введите новый пароль">
    </div>
      <button type="submit" class="btn btn-primary">Сохранить изменения</button>
  </form>
    <div class="list-group w-auto">
      <div class="container text-center">
        <div class="row">
          <div class="col" style="padding-right:0; padding-left:0;">
            <h3 class="mb-3">Ваши статьи</h3>
            {% for news in news_list %}
            <a href="{{ news.url }}" class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true">
              <img src="{{ user.avatar }}" alt="twbs" width="32" height="32" class="rounded-circle flex-shrink-0">
              <div class="d-flex gap-2 w-100 justify-content-between">
                <div>
                  <h6 class="mb-0">{{ news.title }}</h6>
                  <p class="mb-0 opacity-75">{{ news.description }}</p>
                </div>
                <small class="opacity-50 text-nowrap">{{ news.written.strftime('%d.%m.%Y') }}</small>
              </div>
            </a>
        {% endfor %}
          </div>
          <div class="col" style="padding-right:0; padding-left:0;">
            <h3 class="mb-3">Понравилось</h3>
            {% for news in favorite_list %}
            <a href="{{ news.url }}" class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true">
              <img src="{{ user.avatar }}" alt="twbs" width="32" height="32" class="rounded-circle flex-shrink-0">
              <div class="d-flex gap-2 w-100 justify-content-between">
                <div>
                  <h6 class="mb-0">{{ news.title }}</h6>
                  <p class="mb-0 opacity-75">{{ news.description }}</p>
                </div>
                <small class="opacity-50 text-nowrap">{{ news.written.strftime('%d.%m.%Y') }}</small>
              </div>
            </a>
        {% endfor %}
          </div>
        </div>
      </div>
      </div>
    {% endif %}
</div>

{% endblock %}
